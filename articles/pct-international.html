<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>International application of the PCT methods • pct</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="International application of the PCT methods">
<meta property="og:description" content="pct">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pct</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/pct.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cycling-potential-uk.html">Cycling potential in UK cities</a>
    </li>
    <li>
      <a href="../articles/km-cycled.html">Estimating distance cycled per zone in England and Wales regions</a>
    </li>
    <li>
      <a href="../articles/pct-international.html">International application of the PCT methods</a>
    </li>
    <li>
      <a href="../articles/uk-cities.html">Reproducing cycling potential estimates in UK cities</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ITSLeeds/pct/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>International application of the PCT
methods</h1>
                        <h4 data-toc-skip class="author">Robin Lovelace,
Layik Hama</h4>
            
            <h4 data-toc-skip class="date">2023-05-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ITSLeeds/pct/blob/HEAD/vignettes/pct-international.Rmd" class="external-link"><code>vignettes/pct-international.Rmd</code></a></small>
      <div class="hidden name"><code>pct-international.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The package README shows how the PCT can be used to get and reproduce
some of the datasets from the PCT package, based on an example in the
city of Leeds. This vignette shows how the package can be used to create
estimates of cycling potential in other cities.</p>
<p>Set <code>eval=TRUE</code> to run this code when knitting:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>eval <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Let’s start by loading the package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::install_github("ATFutures/geoplumber")</span></span>
<span><span class="co"># require("geojsonsf")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://itsleeds.github.io/pct/" class="external-link">pct</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>The input data for this vignetted was created using code in the <a href="https://github.com/pedalea/pctSantiago" class="external-link">pctSantiago</a> project.
It looks like this, in terms of the flow data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">santiago_od</span><span class="op">)</span></span></code></pre></div>
<p>In terms of the zone data, they look like this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sf</span><span class="fu">:::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">print.sf</a></span><span class="op">(</span><span class="va">santiago_zones</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">santiago_zones</span><span class="op">)</span></span></code></pre></div>
<p>Note that we have cycling estimates for each desire line. If this
data is not known, current cycling levels can be approximated for all
desire lines as the city-wide average, e.g. around 5% for Santiago.</p>
</div>
<div class="section level2">
<h2 id="creating-desire-lines">Creating desire lines<a class="anchor" aria-label="anchor" href="#creating-desire-lines"></a>
</h2>
<p>The origin-destination data can be converted to geographic desire
lines using the <code>stplanr</code> function <code>od2line</code> as
follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">desire_lines</span> <span class="op">=</span> <span class="fu">stplanr</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/stplanr/reference/od2line.html" class="external-link">od2line</a></span><span class="op">(</span>flow <span class="op">=</span> <span class="va">santiago_od</span>, zones <span class="op">=</span> <span class="va">santiago_zones</span><span class="op">)</span></span></code></pre></div>
<p>The resulting lines can then be plotted on top of zone data as
follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">santiago_zones</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">santiago_lines</span><span class="op">[</span><span class="st">"pcycle"</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="va">santiago_lines</span><span class="op">$</span><span class="va">n</span> <span class="op">/</span> <span class="fl">3</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># gj = geojsonsf::sf_geojson(santiago_lines)</span></span>
<span><span class="co"># path = file.path(tempdir(), "dl.geojson")</span></span>
<span><span class="co"># write(gj, path)</span></span>
<span><span class="co"># html_map = geoplumber::gp_map(path, browse_map = FALSE)</span></span>
<span><span class="co"># htmltools::includeHTML(html_map)</span></span></code></pre></div>
<p>The previous map suggests that the data is reliable: we have created
a good approximation of the travel pattern in central Santiago.</p>
</div>
<div class="section level2">
<h2 id="estimating-cycling-uptake">Estimating cycling uptake<a class="anchor" aria-label="anchor" href="#estimating-cycling-uptake"></a>
</h2>
<p>To estimate cycling potential, we need estimates of distance and
hilliness. The area under investigation is relatively flat so we can
make the simplifying assumption that hilliness is 0% for all lines
(normally we would get this information from a routing service):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">desire_lines</span><span class="op">$</span><span class="va">hilliness</span> <span class="op">=</span> <span class="fl">0</span></span></code></pre></div>
<p>And what about the distance? We can calculated it as follows (note we
converted this into a numeric object to prevent issues associated with
the <code>units</code> package):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">desire_lines</span><span class="op">$</span><span class="va">distance</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_length</a></span><span class="op">(</span><span class="va">desire_lines</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now we have (very) crude estimates of distance and hilliness, we can
estimate the cycling potential as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">desire_lines</span><span class="op">$</span><span class="va">godutch_pcycle</span> <span class="op">=</span> <span class="fu"><a href="../reference/uptake_pct_godutch.html">uptake_pct_godutch</a></span><span class="op">(</span>distance <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">distance</span>, gradient <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>Let’s take a look at the results, compared with the current levels of
cycling, and compared with distance:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">pcycle</span>, y <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">godutch_pcycle</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">pcycle</span>, y <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">godutch_pcycle</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">distance</span>, y <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">godutch_pcycle</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>As expected, there is a positive (albeit small) positive correlation
between current and potential levels of cycling. The result shows
clearly that distance decay kicks in just after 2km, but still at 8 km
there is a 25% mode share, suggesting a major switch to cycling.</p>
<p>We can put the results on a map as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addPolylines</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">desire_lines</span>, weight <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">pcycle</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addPolylines</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">desire_lines</span>, weight <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">godutch_pcycle</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>The results show that there is substantial potential for increasing
the levels of cycling in central Santiago, based on origin-destination
data alone. However, to inform policy, more detailed estimates of
cycling potential are needed, with results that go down to the level of
individual streets. This involves routing.</p>
</div>
<div class="section level2">
<h2 id="routing">Routing<a class="anchor" aria-label="anchor" href="#routing"></a>
</h2>
<p>There are many ways to do calculate a path on the street network. The
main options are local routing, where the calculation is done based on
data stored locally (on your computer) and routing services, where the
data is done remotely (‘in the cloud’). Let’s use a remote routing
service to convert the straight lines generated in the previous section
into routes that could realistically be taken by people cycling (the
next line does not run by default because it requires an API key saved
as an environment variable, see the <a href="https://docs.ropensci.org/stplanr/reference/index.html#section-routing" class="external-link">documentation
of <code>route_cyclestreets()</code> for details</a> for details).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">santiago_routes_cs</span> <span class="op">=</span> <span class="fu">stplanr</span><span class="fu">::</span><span class="fu">line2route</span><span class="op">(</span><span class="va">desire_lines</span><span class="op">)</span></span>
<span><span class="co"># &gt; 10 % out of 200 distances calculated</span></span>
<span><span class="co"># &gt; 20 % out of 200 distances calculated</span></span>
<span><span class="co"># &gt; 30 % out of 200 distances calculated</span></span>
<span><span class="co"># &gt; 40 % out of 200 distances calculated</span></span>
<span><span class="co"># &gt; 50 % out of 200 distances calculated</span></span>
<span><span class="co"># &gt; 60 % out of 200 distances calculated</span></span>
<span><span class="co"># &gt; 70 % out of 200 distances calculated</span></span>
<span><span class="co"># &gt; 80 % out of 200 distances calculated</span></span>
<span><span class="co"># &gt; 90 % out of 200 distances calculated</span></span>
<span><span class="co"># &gt; 100 % out of 200 distances calculated</span></span>
<span><span class="co"># &gt; Warning message:</span></span>
<span><span class="co"># &gt; In value[[3L]](cond) : Fail for line number 32</span></span></code></pre></div>
<p>Note that one of the routes failed. We can look at this route as
follows, to try to understand what happened:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addPolylines</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">santiago_routes_cs</span><span class="op">[</span><span class="fl">32</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>The result shows that one end of the route connects to the Sendero
Ciclistas, which the routing service may be unable to reach. At this
stage there are 2 main options: 1) to omit the data point from the
analysis, acknowledging that the data is incomplete; or 2) identify a
nearby location where the service <em>can</em> route to. In this case we
will take option 1. Before we remove the offending line 32 from the
analysis, we will join the data from the desire lines back onto the
results:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">routes</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">santiago_routes_cs</span><span class="op">)</span>,</span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">desire_lines</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  geometry <span class="op">=</span> <span class="va">santiago_routes_cs</span><span class="op">$</span><span class="va">geometry</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Update results…</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">routes</span><span class="op">$</span><span class="va">godutch_slc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">routes</span><span class="op">$</span><span class="va">godutch_pcycle</span> <span class="op">*</span> <span class="va">routes</span><span class="op">$</span><span class="va">all</span><span class="op">)</span></span>
<span><span class="va">rnet</span> <span class="op">=</span> <span class="fu">stplanr</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/stplanr/reference/overline.html" class="external-link">overline2</a></span><span class="op">(</span><span class="va">routes</span>, <span class="st">"godutch_slc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rnet</span>, lwd <span class="op">=</span> <span class="va">rnet</span><span class="op">$</span><span class="va">godutch_slc</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rnet</span><span class="op">$</span><span class="va">godutch_slc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># library(tmap)</span></span>
<span><span class="co"># tmap_mode("view")</span></span>
<span><span class="co">#   tm_shape(rnet) +</span></span>
<span><span class="co">#   tm_lines(lwd = "godutch_slc", scale = 9) </span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>Clearly to do this in a production environment we would use a larger
dataset, but the concepts would be the same. We would refine the method
in multiple ways. The next basic step, however, would be to convert the
straight desire lines into routes, to calculate more accurate distance
and hilliness levels for each OD pair. Then we would be able to create a
route network to help prioritise cycling across the city.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">route_segments_1_5</span> <span class="op">=</span> <span class="fu">route</span><span class="op">(</span>l <span class="op">=</span> <span class="va">desire_lines</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span>, route_fun <span class="op">=</span> <span class="fu">cyclestreets</span><span class="fu">::</span><span class="va">journey</span><span class="op">)</span></span>
<span><span class="fu">mapview</span><span class="fu">::</span><span class="fu">mapview</span><span class="op">(</span><span class="va">route_segments_1_5</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Robin Lovelace, Layik Hama.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

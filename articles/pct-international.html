<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>International application of the PCT methods • pct</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="International application of the PCT methods">
<meta property="og:description" content="pct">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pct</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/pct.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cycling-potential-uk.html">Cycling potential in UK cities</a>
    </li>
    <li>
      <a href="../articles/getting.html">Getting and using data from the PCT</a>
    </li>
    <li>
      <a href="../articles/km-cycled.html">Estimating distance cycled per zone in England and Wales regions</a>
    </li>
    <li>
      <a href="../articles/pct-international.html">International application of the PCT methods</a>
    </li>
    <li>
      <a href="../articles/pct_training.html">Propensity to Cycle Tool Advanced Workshop</a>
    </li>
    <li>
      <a href="../articles/uk-cities.html">Reproducing cycling potential estimates in UK cities</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ITSLeeds/pct/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="pct-international_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="pct-international_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="pct-international_files/jquery-1.12.4/jquery.min.js"></script><link href="pct-international_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="pct-international_files/leaflet-1.3.1/leaflet.js"></script><link href="pct-international_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="pct-international_files/proj4-2.6.2/proj4.min.js"></script><script src="pct-international_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="pct-international_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="pct-international_files/leaflet-binding-2.0.4.1/leaflet.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>International application of the PCT methods</h1>
                        <h4 data-toc-skip class="author">Robin Lovelace, Layik Hama</h4>
            
            <h4 data-toc-skip class="date">2021-12-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ITSLeeds/pct/blob/HEAD/vignettes/pct-international.Rmd" class="external-link"><code>vignettes/pct-international.Rmd</code></a></small>
      <div class="hidden name"><code>pct-international.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The package README shows how the PCT can be used to get and reproduce some of the datasets from the PCT package, based on an example in the city of Leeds. This vignette shows how the package can be used to create estimates of cycling potential in other cities.</p>
<p>Let’s start by loading the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># devtools::install_github("ATFutures/geoplumber")</span>
<span class="co"># require("geojsonsf")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://itsleeds.github.io/pct/" class="external-link">pct</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>The input data for this vignetted was created using code in the <a href="https://github.com/pedalea/pctSantiago" class="external-link">pctSantiago</a> project. It looks like this, in terms of the flow data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">santiago_od</span><span class="op">)</span>
<span class="co">#&gt;   ZonaOrigen ZonaDestino  n av_weight      all range_weights pcycle</span>
<span class="co">#&gt; 1        259         497  5  690.5146 3452.573      62.42723      0</span>
<span class="co">#&gt; 2        260         261 17  205.6069 3495.318     967.24461      0</span>
<span class="co">#&gt; 3        261         260 17  227.5245 3867.916     967.24461      0</span>
<span class="co">#&gt; 4        263         264  5  517.2128 2586.064     819.21471      0</span>
<span class="co">#&gt; 5        264         263  5  508.4814 2542.407     852.77144      0</span>
<span class="co">#&gt; 6        266         501  2 1982.2633 3964.527    1700.07456      0</span></code></pre></div>
<p>In terms of the zone data, they look like this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">sf</span><span class="fu">:::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">print.sf</a></span><span class="op">(</span><span class="va">santiago_zones</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 75 features and 1 field</span>
<span class="co">#&gt; Geometry type: POLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -70.69203 ymin: -33.47766 xmax: -70.58239 ymax: -33.403</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; Geodetic CRS:  WGS 84</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt;     geo_code                       geometry</span>
<span class="co">#&gt; 259      259 POLYGON ((-70.65174 -33.431...</span>
<span class="co">#&gt; 260      260 POLYGON ((-70.65008 -33.443...</span>
<span class="co">#&gt; 261      261 POLYGON ((-70.64562 -33.437...</span>
<span class="co">#&gt; 262      262 POLYGON ((-70.64643 -33.477...</span>
<span class="co">#&gt; 263      263 POLYGON ((-70.64913 -33.459...</span>
<span class="co">#&gt; 264      264 POLYGON ((-70.64914 -33.459...</span>
<span class="co">#&gt; 265      265 POLYGON ((-70.65058 -33.450...</span>
<span class="co">#&gt; 266      266 POLYGON ((-70.65058 -33.450...</span>
<span class="co">#&gt; 292      292 POLYGON ((-70.60615 -33.419...</span>
<span class="co">#&gt; 293      293 POLYGON ((-70.60673 -33.415...</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">santiago_zones</span><span class="op">)</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span></code></pre></div>
<p><img src="pct-international_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>Note that we have cycling estimates for each desire line. If this data is not known, current cycling levels can be approximated for all desire lines as the city-wide average, e.g. around 5% for Santiago.</p>
</div>
<div class="section level2">
<h2 id="creating-desire-lines">Creating desire lines<a class="anchor" aria-label="anchor" href="#creating-desire-lines"></a>
</h2>
<p>The origin-destination data can be converted to geographic desire lines using the <code>stplanr</code> function <code>od2line</code> as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">desire_lines</span> <span class="op">=</span> <span class="fu">stplanr</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/stplanr/reference/od2line.html" class="external-link">od2line</a></span><span class="op">(</span>flow <span class="op">=</span> <span class="va">santiago_od</span>, zones <span class="op">=</span> <span class="va">santiago_zones</span><span class="op">)</span>
<span class="co">#&gt; Creating centroids representing desire line start and end points.</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span></code></pre></div>
<p>The resulting lines can then be plotted on top of zone data as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">santiago_zones</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">santiago_lines</span><span class="op">[</span><span class="st">"pcycle"</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="va">santiago_lines</span><span class="op">$</span><span class="va">n</span> <span class="op">/</span> <span class="fl">3</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span></code></pre></div>
<p><img src="pct-international_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># gj = geojsonsf::sf_geojson(santiago_lines)</span>
<span class="co"># path = file.path(tempdir(), "dl.geojson")</span>
<span class="co"># write(gj, path)</span>
<span class="co"># html_map = geoplumber::gp_map(path, browse_map = FALSE)</span>
<span class="co"># htmltools::includeHTML(html_map)</span></code></pre></div>
<p>The previous map suggests that the data is reliable: we have created a good approximation of the travel pattern in central Santiago.</p>
</div>
<div class="section level2">
<h2 id="estimating-cycling-uptake">Estimating cycling uptake<a class="anchor" aria-label="anchor" href="#estimating-cycling-uptake"></a>
</h2>
<p>To estimate cycling potential, we need estimates of distance and hilliness. The area under investigation is relatively flat so we can make the simplifying assumption that hilliness is 0% for all lines (normally we would get this information from a routing service):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">desire_lines</span><span class="op">$</span><span class="va">hilliness</span> <span class="op">=</span> <span class="fl">0</span></code></pre></div>
<p>And what about the distance? We can calculated it as follows (note we converted this into a numeric object to prevent issues associated with the <code>units</code> package):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">desire_lines</span><span class="op">$</span><span class="va">distance</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_length</a></span><span class="op">(</span><span class="va">desire_lines</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now we have (very) crude estimates of distance and hilliness, we can estimate the cycling potential as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">desire_lines</span><span class="op">$</span><span class="va">godutch_pcycle</span> <span class="op">=</span> <span class="fu"><a href="../reference/uptake_pct_godutch.html">uptake_pct_godutch</a></span><span class="op">(</span>distance <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">distance</span>, gradient <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>Let’s take a look at the results, compared with the current levels of cycling, and compared with distance:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">pcycle</span>, y <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">godutch_pcycle</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.08756203</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">pcycle</span>, y <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">godutch_pcycle</span><span class="op">)</span></code></pre></div>
<p><img src="pct-international_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">distance</span>, y <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">godutch_pcycle</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="pct-international_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<p>As expected, there is a positive (albeit small) positive correlation between current and potential levels of cycling. The result shows clearly that distance decay kicks in just after 2km, but still at 8 km there is a 25% mode share, suggesting a major switch to cycling.</p>
<p>We can put the results on a map as follows:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addPolylines</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">desire_lines</span>, weight <span class="op">=</span> <span class="va">desire_lines</span><span class="op">$</span><span class="va">pcycle</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-50f1271a3567d67372b2" style="width:100%;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-50f1271a3567d67372b2">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPolylines","args":[[[[{"lng":[-70.650434858097,-70.6526255505942],"lat":[-33.4343838036132,-33.4671693192229]}]],[[{"lng":[-70.6495073830014,-70.6453902488202],"lat":[-33.4403834863821,-33.4351710188071]}]],[[{"lng":[-70.6453902488202,-70.6495073830014],"lat":[-33.4351710188071,-33.4403834863821]}]],[[{"lng":[-70.6457308854672,-70.6466592680034],"lat":[-33.4642708479547,-33.4563767538852]}]],[[{"lng":[-70.6466592680034,-70.6457308854672],"lat":[-33.4563767538852,-33.4642708479547]}]],[[{"lng":[-70.6481561394314,-70.6661174372699],"lat":[-33.446832173693,-33.4301412600966]}]],[[{"lng":[-70.6481561394314,-70.670733374992],"lat":[-33.446832173693,-33.4457783941942]}]],[[{"lng":[-70.6074971506533,-70.6526255505942],"lat":[-33.42597543057,-33.4671693192229]}]],[[{"lng":[-70.6074971506533,-70.6718290234332],"lat":[-33.42597543057,-33.4350884899849]}]],[[{"lng":[-70.6095995931768,-70.614076885476],"lat":[-33.4204893918155,-33.4150451761182]}]],[[{"lng":[-70.614076885476,-70.6074971506533],"lat":[-33.4150451761182,-33.42597543057]}]],[[{"lng":[-70.614076885476,-70.6095995931768],"lat":[-33.4150451761182,-33.4204893918155]}]],[[{"lng":[-70.5981232718602,-70.6572126224758],"lat":[-33.4265026274536,-33.4498187472731]}]],[[{"lng":[-70.5981232718602,-70.637275123409],"lat":[-33.4265026274536,-33.4546390844503]}]],[[{"lng":[-70.6012948054121,-70.6733986306119],"lat":[-33.42186018188,-33.4300771552172]}]],[[{"lng":[-70.6012948054121,-70.6774896364247],"lat":[-33.42186018188,-33.4355112027072]}]],[[{"lng":[-70.6012948054121,-70.6123578082606],"lat":[-33.42186018188,-33.4355251923086]}]],[[{"lng":[-70.6012948054121,-70.5912225207452],"lat":[-33.42186018188,-33.4345660126086]}]],[[{"lng":[-70.6285692069969,-70.651680306137],"lat":[-33.4265365578799,-33.4736786260841]}]],[[{"lng":[-70.6785522214009,-70.6858063373839],"lat":[-33.4301449875544,-33.441545791766]}]],[[{"lng":[-70.6534578266908,-70.6858063373839],"lat":[-33.4572409358982,-33.441545791766]}]],[[{"lng":[-70.6593539992795,-70.6377516282806],"lat":[-33.4738456668857,-33.4598208208412]}]],[[{"lng":[-70.6674172760907,-70.6673293221026],"lat":[-33.4636868248438,-33.4735215340682]}]],[[{"lng":[-70.6673293221026,-70.6674172760907],"lat":[-33.4735215340682,-33.4636868248438]}]],[[{"lng":[-70.6673293221026,-70.6735981986333],"lat":[-33.4735215340682,-33.469865788945]}]],[[{"lng":[-70.6673293221026,-70.6123578082606],"lat":[-33.4735215340682,-33.4355251923086]}]],[[{"lng":[-70.6735981986333,-70.6673293221026],"lat":[-33.469865788945,-33.4735215340682]}]],[[{"lng":[-70.6735981986333,-70.651680306137],"lat":[-33.469865788945,-33.4736786260841]}]],[[{"lng":[-70.6735981986333,-70.6713399356771],"lat":[-33.469865788945,-33.4404647516981]}]],[[{"lng":[-70.6735981986333,-70.6764743607833],"lat":[-33.469865788945,-33.4469856853689]}]],[[{"lng":[-70.6735981986333,-70.6551960308114],"lat":[-33.469865788945,-33.4340428489674]}]],[[{"lng":[-70.651680306137,-70.6285692069969],"lat":[-33.4736786260841,-33.4265365578799]}]],[[{"lng":[-70.651680306137,-70.6735981986333],"lat":[-33.4736786260841,-33.469865788945]}]],[[{"lng":[-70.651680306137,-70.6661174372699],"lat":[-33.4736786260841,-33.4301412600966]}]],[[{"lng":[-70.651680306137,-70.6774896364247],"lat":[-33.4736786260841,-33.4355112027072]}]],[[{"lng":[-70.6752246175601,-70.6718290234332],"lat":[-33.4626408609166,-33.4350884899849]}]],[[{"lng":[-70.6752246175601,-70.6774896364247],"lat":[-33.4626408609166,-33.4355112027072]}]],[[{"lng":[-70.6602457027671,-70.6526255505942],"lat":[-33.464301260726,-33.4671693192229]}]],[[{"lng":[-70.6602457027671,-70.6529723507626],"lat":[-33.464301260726,-33.4621181229437]}]],[[{"lng":[-70.6602457027671,-70.6713399356771],"lat":[-33.464301260726,-33.4404647516981]}]],[[{"lng":[-70.6602457027671,-70.6583561582847],"lat":[-33.464301260726,-33.4419715202788]}]],[[{"lng":[-70.6602457027671,-70.6764743607833],"lat":[-33.464301260726,-33.4469856853689]}]],[[{"lng":[-70.6602457027671,-70.6528539094186],"lat":[-33.464301260726,-33.4498033485925]}]],[[{"lng":[-70.6526255505942,-70.650434858097],"lat":[-33.4671693192229,-33.4343838036132]}]],[[{"lng":[-70.6526255505942,-70.6074971506533],"lat":[-33.4671693192229,-33.42597543057]}]],[[{"lng":[-70.6526255505942,-70.6602457027671],"lat":[-33.4671693192229,-33.464301260726]}]],[[{"lng":[-70.6526255505942,-70.6529723507626],"lat":[-33.4671693192229,-33.4621181229437]}]],[[{"lng":[-70.6526255505942,-70.6770373116317],"lat":[-33.4671693192229,-33.4409810468126]}]],[[{"lng":[-70.6526255505942,-70.6713399356771],"lat":[-33.4671693192229,-33.4404647516981]}]],[[{"lng":[-70.6526255505942,-70.6661174372699],"lat":[-33.4671693192229,-33.4301412600966]}]],[[{"lng":[-70.6526255505942,-70.6642333096546],"lat":[-33.4671693192229,-33.4398236374009]}]],[[{"lng":[-70.6526255505942,-70.6764743607833],"lat":[-33.4671693192229,-33.4469856853689]}]],[[{"lng":[-70.6526255505942,-70.670733374992],"lat":[-33.4671693192229,-33.4457783941942]}]],[[{"lng":[-70.6526255505942,-70.6590576555109],"lat":[-33.4671693192229,-33.4330876589]}]],[[{"lng":[-70.6526255505942,-70.637275123409],"lat":[-33.4671693192229,-33.4546390844503]}]],[[{"lng":[-70.6529723507626,-70.6593539992795],"lat":[-33.4621181229437,-33.4738456668857]}]],[[{"lng":[-70.6529723507626,-70.6602457027671],"lat":[-33.4621181229437,-33.464301260726]}]],[[{"lng":[-70.6529723507626,-70.6526255505942],"lat":[-33.4621181229437,-33.4671693192229]}]],[[{"lng":[-70.6529723507626,-70.6713399356771],"lat":[-33.4621181229437,-33.4404647516981]}]],[[{"lng":[-70.6529723507626,-70.6661174372699],"lat":[-33.4621181229437,-33.4301412600966]}]],[[{"lng":[-70.6529723507626,-70.6764743607833],"lat":[-33.4621181229437,-33.4469856853689]}]],[[{"lng":[-70.6529723507626,-70.670733374992],"lat":[-33.4621181229437,-33.4457783941942]}]],[[{"lng":[-70.6529723507626,-70.6528539094186],"lat":[-33.4621181229437,-33.4498033485925]}]],[[{"lng":[-70.6529723507626,-70.6590576555109],"lat":[-33.4621181229437,-33.4330876589]}]],[[{"lng":[-70.6529723507626,-70.6551960308114],"lat":[-33.4621181229437,-33.4340428489674]}]],[[{"lng":[-70.6529723507626,-70.631024899717],"lat":[-33.4621181229437,-33.4628822123352]}]],[[{"lng":[-70.6770373116317,-70.6526255505942],"lat":[-33.4409810468126,-33.4671693192229]}]],[[{"lng":[-70.6770373116317,-70.6713399356771],"lat":[-33.4409810468126,-33.4404647516981]}]],[[{"lng":[-70.6770373116317,-70.6661174372699],"lat":[-33.4409810468126,-33.4301412600966]}]],[[{"lng":[-70.6713399356771,-70.6074971506533],"lat":[-33.4404647516981,-33.42597543057]}]],[[{"lng":[-70.6713399356771,-70.6735981986333],"lat":[-33.4404647516981,-33.469865788945]}]],[[{"lng":[-70.6713399356771,-70.6602457027671],"lat":[-33.4404647516981,-33.464301260726]}]],[[{"lng":[-70.6713399356771,-70.6526255505942],"lat":[-33.4404647516981,-33.4671693192229]}]],[[{"lng":[-70.6713399356771,-70.6529723507626],"lat":[-33.4404647516981,-33.4621181229437]}]],[[{"lng":[-70.6713399356771,-70.6770373116317],"lat":[-33.4404647516981,-33.4409810468126]}]],[[{"lng":[-70.6713399356771,-70.6647209084766],"lat":[-33.4404647516981,-33.4355753657536]}]],[[{"lng":[-70.6713399356771,-70.6642333096546],"lat":[-33.4404647516981,-33.4398236374009]}]],[[{"lng":[-70.6713399356771,-70.6764743607833],"lat":[-33.4404647516981,-33.4469856853689]}]],[[{"lng":[-70.6713399356771,-70.6718290234332],"lat":[-33.4404647516981,-33.4350884899849]}]],[[{"lng":[-70.6713399356771,-70.5912225207452],"lat":[-33.4404647516981,-33.4345660126086]}]],[[{"lng":[-70.6661174372699,-70.6481561394314],"lat":[-33.4301412600966,-33.446832173693]}]],[[{"lng":[-70.6661174372699,-70.651680306137],"lat":[-33.4301412600966,-33.4736786260841]}]],[[{"lng":[-70.6661174372699,-70.6526255505942],"lat":[-33.4301412600966,-33.4671693192229]}]],[[{"lng":[-70.6661174372699,-70.6647209084766],"lat":[-33.4301412600966,-33.4355753657536]}]],[[{"lng":[-70.6661174372699,-70.6718290234332],"lat":[-33.4301412600966,-33.4350884899849]}]],[[{"lng":[-70.6661174372699,-70.6774896364247],"lat":[-33.4301412600966,-33.4355112027072]}]],[[{"lng":[-70.6661174372699,-70.6528539094186],"lat":[-33.4301412600966,-33.4498033485925]}]],[[{"lng":[-70.6647209084766,-70.6661174372699],"lat":[-33.4355753657536,-33.4301412600966]}]],[[{"lng":[-70.6647209084766,-70.6528539094186],"lat":[-33.4355753657536,-33.4498033485925]}]],[[{"lng":[-70.6647209084766,-70.6590576555109],"lat":[-33.4355753657536,-33.4330876589]}]],[[{"lng":[-70.6642333096546,-70.6526255505942],"lat":[-33.4398236374009,-33.4671693192229]}]],[[{"lng":[-70.6642333096546,-70.6713399356771],"lat":[-33.4398236374009,-33.4404647516981]}]],[[{"lng":[-70.6642758332154,-70.6590576555109],"lat":[-33.4446572092606,-33.4330876589]}]],[[{"lng":[-70.6583561582847,-70.6602457027671],"lat":[-33.4419715202788,-33.464301260726]}]],[[{"lng":[-70.6583561582847,-70.6764743607833],"lat":[-33.4419715202788,-33.4469856853689]}]],[[{"lng":[-70.6583561582847,-70.6572126224758],"lat":[-33.4419715202788,-33.4498187472731]}]],[[{"lng":[-70.6542364764179,-70.6528539094186],"lat":[-33.441245136987,-33.4498033485925]}]],[[{"lng":[-70.6764743607833,-70.6602457027671],"lat":[-33.4469856853689,-33.464301260726]}]],[[{"lng":[-70.6764743607833,-70.6529723507626],"lat":[-33.4469856853689,-33.4621181229437]}]],[[{"lng":[-70.6764743607833,-70.6713399356771],"lat":[-33.4469856853689,-33.4404647516981]}]],[[{"lng":[-70.6764743607833,-70.6642333096546],"lat":[-33.4469856853689,-33.4398236374009]}]],[[{"lng":[-70.6764743607833,-70.6583561582847],"lat":[-33.4469856853689,-33.4419715202788]}]],[[{"lng":[-70.6764743607833,-70.670733374992],"lat":[-33.4469856853689,-33.4457783941942]}]],[[{"lng":[-70.6764743607833,-70.6528539094186],"lat":[-33.4469856853689,-33.4498033485925]}]],[[{"lng":[-70.6764743607833,-70.5949751541645],"lat":[-33.4469856853689,-33.4306315476572]}]],[[{"lng":[-70.670733374992,-70.6481561394314],"lat":[-33.4457783941942,-33.446832173693]}]],[[{"lng":[-70.670733374992,-70.6602457027671],"lat":[-33.4457783941942,-33.464301260726]}]],[[{"lng":[-70.670733374992,-70.6526255505942],"lat":[-33.4457783941942,-33.4671693192229]}]],[[{"lng":[-70.670733374992,-70.6529723507626],"lat":[-33.4457783941942,-33.4621181229437]}]],[[{"lng":[-70.670733374992,-70.6764743607833],"lat":[-33.4457783941942,-33.4469856853689]}]],[[{"lng":[-70.6733986306119,-70.6526255505942],"lat":[-33.4300771552172,-33.4671693192229]}]],[[{"lng":[-70.6733986306119,-70.6642758332154],"lat":[-33.4300771552172,-33.4446572092606]}]],[[{"lng":[-70.6733986306119,-70.6718290234332],"lat":[-33.4300771552172,-33.4350884899849]}]],[[{"lng":[-70.6733986306119,-70.6774896364247],"lat":[-33.4300771552172,-33.4355112027072]}]],[[{"lng":[-70.6733986306119,-70.6590576555109],"lat":[-33.4300771552172,-33.4330876589]}]],[[{"lng":[-70.6718290234332,-70.6074971506533],"lat":[-33.4350884899849,-33.42597543057]}]],[[{"lng":[-70.6718290234332,-70.6752246175601],"lat":[-33.4350884899849,-33.4626408609166]}]],[[{"lng":[-70.6718290234332,-70.6529723507626],"lat":[-33.4350884899849,-33.4621181229437]}]],[[{"lng":[-70.6718290234332,-70.6661174372699],"lat":[-33.4350884899849,-33.4301412600966]}]],[[{"lng":[-70.6718290234332,-70.6774896364247],"lat":[-33.4350884899849,-33.4355112027072]}]],[[{"lng":[-70.6774896364247,-70.6012948054121],"lat":[-33.4355112027072,-33.42186018188]}]],[[{"lng":[-70.6774896364247,-70.651680306137],"lat":[-33.4355112027072,-33.4736786260841]}]],[[{"lng":[-70.6774896364247,-70.6752246175601],"lat":[-33.4355112027072,-33.4626408609166]}]],[[{"lng":[-70.6774896364247,-70.6642333096546],"lat":[-33.4355112027072,-33.4398236374009]}]],[[{"lng":[-70.6774896364247,-70.6733986306119],"lat":[-33.4355112027072,-33.4300771552172]}]],[[{"lng":[-70.6774896364247,-70.6718290234332],"lat":[-33.4355112027072,-33.4350884899849]}]],[[{"lng":[-70.6774896364247,-70.6296037029705],"lat":[-33.4355112027072,-33.4696442284046]}]],[[{"lng":[-70.6572126224758,-70.5981232718602],"lat":[-33.4498187472731,-33.4265026274536]}]],[[{"lng":[-70.6572126224758,-70.6583561582847],"lat":[-33.4498187472731,-33.4419715202788]}]],[[{"lng":[-70.6572126224758,-70.6733986306119],"lat":[-33.4498187472731,-33.4300771552172]}]],[[{"lng":[-70.6528539094186,-70.6602457027671],"lat":[-33.4498033485925,-33.464301260726]}]],[[{"lng":[-70.6528539094186,-70.6526255505942],"lat":[-33.4498033485925,-33.4671693192229]}]],[[{"lng":[-70.6528539094186,-70.6529723507626],"lat":[-33.4498033485925,-33.4621181229437]}]],[[{"lng":[-70.6528539094186,-70.6647209084766],"lat":[-33.4498033485925,-33.4355753657536]}]],[[{"lng":[-70.6528539094186,-70.6542364764179],"lat":[-33.4498033485925,-33.441245136987]}]],[[{"lng":[-70.6528539094186,-70.670733374992],"lat":[-33.4498033485925,-33.4457783941942]}]],[[{"lng":[-70.6590576555109,-70.6526255505942],"lat":[-33.4330876589,-33.4671693192229]}]],[[{"lng":[-70.6590576555109,-70.6529723507626],"lat":[-33.4330876589,-33.4621181229437]}]],[[{"lng":[-70.6590576555109,-70.6647209084766],"lat":[-33.4330876589,-33.4355753657536]}]],[[{"lng":[-70.6590576555109,-70.6642758332154],"lat":[-33.4330876589,-33.4446572092606]}]],[[{"lng":[-70.6590576555109,-70.6733986306119],"lat":[-33.4330876589,-33.4300771552172]}]],[[{"lng":[-70.6590576555109,-70.6528539094186],"lat":[-33.4330876589,-33.4498033485925]}]],[[{"lng":[-70.6551960308114,-70.6466592680034],"lat":[-33.4340428489674,-33.4563767538852]}]],[[{"lng":[-70.637275123409,-70.5981232718602],"lat":[-33.4546390844503,-33.4265026274536]}]],[[{"lng":[-70.637275123409,-70.6526255505942],"lat":[-33.4546390844503,-33.4671693192229]}]],[[{"lng":[-70.637275123409,-70.631024899717],"lat":[-33.4546390844503,-33.4628822123352]}]],[[{"lng":[-70.631024899717,-70.6529723507626],"lat":[-33.4628822123352,-33.4621181229437]}]],[[{"lng":[-70.631024899717,-70.637275123409],"lat":[-33.4628822123352,-33.4546390844503]}]],[[{"lng":[-70.6206661133164,-70.6356675455178],"lat":[-33.4438231516899,-33.4717301363876]}]],[[{"lng":[-70.6108265415944,-70.6356675455178],"lat":[-33.4424221730401,-33.4717301363876]}]],[[{"lng":[-70.6123578082606,-70.6356675455178],"lat":[-33.4355251923086,-33.4717301363876]}]],[[{"lng":[-70.6356675455178,-70.6206661133164],"lat":[-33.4717301363876,-33.4438231516899]}]],[[{"lng":[-70.6356675455178,-70.6108265415944],"lat":[-33.4717301363876,-33.4424221730401]}]],[[{"lng":[-70.6356675455178,-70.6123578082606],"lat":[-33.4717301363876,-33.4355251923086]}]],[[{"lng":[-70.6356675455178,-70.6296037029705],"lat":[-33.4717301363876,-33.4696442284046]}]],[[{"lng":[-70.6356675455178,-70.6341487532638],"lat":[-33.4717301363876,-33.446893522726]}]],[[{"lng":[-70.6296037029705,-70.6774896364247],"lat":[-33.4696442284046,-33.4355112027072]}]],[[{"lng":[-70.6296037029705,-70.6356675455178],"lat":[-33.4696442284046,-33.4717301363876]}]],[[{"lng":[-70.6296037029705,-70.6341487532638],"lat":[-33.4696442284046,-33.446893522726]}]],[[{"lng":[-70.6377516282806,-70.6593539992795],"lat":[-33.4598208208412,-33.4738456668857]}]],[[{"lng":[-70.6377516282806,-70.644601717137],"lat":[-33.4598208208412,-33.4400985482313]}]],[[{"lng":[-70.6377516282806,-70.6312044546103],"lat":[-33.4598208208412,-33.438242424246]}]],[[{"lng":[-70.638602501405,-70.641797063688],"lat":[-33.4657345509482,-33.44407850438]}]],[[{"lng":[-70.644601717137,-70.6377516282806],"lat":[-33.4400985482313,-33.4598208208412]}]],[[{"lng":[-70.644601717137,-70.6341487532638],"lat":[-33.4400985482313,-33.446893522726]}]],[[{"lng":[-70.644601717137,-70.6368724960347],"lat":[-33.4400985482313,-33.4402785483282]}]],[[{"lng":[-70.644601717137,-70.6314487503384],"lat":[-33.4400985482313,-33.4328823211947]}]],[[{"lng":[-70.6341487532638,-70.6206661133164],"lat":[-33.446893522726,-33.4438231516899]}]],[[{"lng":[-70.6341487532638,-70.6356675455178],"lat":[-33.446893522726,-33.4717301363876]}]],[[{"lng":[-70.6341487532638,-70.6296037029705],"lat":[-33.446893522726,-33.4696442284046]}]],[[{"lng":[-70.6341487532638,-70.638602501405],"lat":[-33.446893522726,-33.4657345509482]}]],[[{"lng":[-70.6341487532638,-70.644601717137],"lat":[-33.446893522726,-33.4400985482313]}]],[[{"lng":[-70.6341487532638,-70.6368724960347],"lat":[-33.446893522726,-33.4402785483282]}]],[[{"lng":[-70.6341487532638,-70.6312044546103],"lat":[-33.446893522726,-33.438242424246]}]],[[{"lng":[-70.6341487532638,-70.6199652917226],"lat":[-33.446893522726,-33.4349547244951]}]],[[{"lng":[-70.6341487532638,-70.6252869928988],"lat":[-33.446893522726,-33.4361581067883]}]],[[{"lng":[-70.6341487532638,-70.6314487503384],"lat":[-33.446893522726,-33.4328823211947]}]],[[{"lng":[-70.6341487532638,-70.6397451799901],"lat":[-33.446893522726,-33.4493577681257]}]],[[{"lng":[-70.6368724960347,-70.644601717137],"lat":[-33.4402785483282,-33.4400985482313]}]],[[{"lng":[-70.6368724960347,-70.6341487532638],"lat":[-33.4402785483282,-33.446893522726]}]],[[{"lng":[-70.6368724960347,-70.6312044546103],"lat":[-33.4402785483282,-33.438242424246]}]],[[{"lng":[-70.6312044546103,-70.6377516282806],"lat":[-33.438242424246,-33.4598208208412]}]],[[{"lng":[-70.6312044546103,-70.6341487532638],"lat":[-33.438242424246,-33.446893522726]}]],[[{"lng":[-70.6312044546103,-70.6368724960347],"lat":[-33.438242424246,-33.4402785483282]}]],[[{"lng":[-70.6199652917226,-70.6377516282806],"lat":[-33.4349547244951,-33.4598208208412]}]],[[{"lng":[-70.6199652917226,-70.6341487532638],"lat":[-33.4349547244951,-33.446893522726]}]],[[{"lng":[-70.6199652917226,-70.6296537305289],"lat":[-33.4349547244951,-33.4451758586847]}]],[[{"lng":[-70.6199652917226,-70.6252869928988],"lat":[-33.4349547244951,-33.4361581067883]}]],[[{"lng":[-70.6252869928988,-70.6341487532638],"lat":[-33.4361581067883,-33.446893522726]}]],[[{"lng":[-70.6252869928988,-70.6199652917226],"lat":[-33.4361581067883,-33.4349547244951]}]],[[{"lng":[-70.6314487503384,-70.644601717137],"lat":[-33.4328823211947,-33.4400985482313]}]],[[{"lng":[-70.6314487503384,-70.6341487532638],"lat":[-33.4328823211947,-33.446893522726]}]],[[{"lng":[-70.6397451799901,-70.6341487532638],"lat":[-33.4493577681257,-33.446893522726]}]],[[{"lng":[-70.641797063688,-70.638602501405],"lat":[-33.44407850438,-33.4657345509482]}]],[[{"lng":[-70.5949751541645,-70.6713399356771],"lat":[-33.4306315476572,-33.4404647516981]}]],[[{"lng":[-70.5949751541645,-70.6764743607833],"lat":[-33.4306315476572,-33.4469856853689]}]],[[{"lng":[-70.6032789286817,-70.5912225207452],"lat":[-33.4413898286572,-33.4345660126086]}]],[[{"lng":[-70.5912225207452,-70.6012948054121],"lat":[-33.4345660126086,-33.42186018188]}]],[[{"lng":[-70.5912225207452,-70.6713399356771],"lat":[-33.4345660126086,-33.4404647516981]}]],[[{"lng":[-70.5912225207452,-70.6032789286817],"lat":[-33.4345660126086,-33.4413898286572]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":[0,0,0,0,0,0,0,0.248172346718238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.282293722540753,0,0.273968817123608,0,0,0,0,0,0,0,0,0,0,0.0229410773948892,0,3.72570690352284,0.230812043364513,0,0,0,0.207361180799769,0,0,0,0,0,0,0.0440641222691342,1.2756200788043,0.112552196058305,0,0,0,0.0684886470220518,0,0,0.0103346287484447,0.390067726506726,0,0,0,0,0,0,0.0646231931933031,0,0,3.7367897845158,0,0,0.281753757852203,0.0809905557331629,0,0,0,0,0,0,0,0,0,0,0,0,1.67368953893967,0,0,0,2.56848328745936,0.173427641131372,0,0,0,0,0.032212711064912,0.257365299612872,0,0,1.53568346782772,0.189381503196976,0,0,0.0541316455850741,0.845315299211642,0,1.60463253642444,0.698274341489197,0,1.43589225207888,0,0.0305796047433976,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.063432885044075,0.0903980671407159,1.70546444297051,0.199622908644014,0.117903803553469,0.134478748227927,0,0,3.33602531574244,0.0341017111003445,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0528448960490816,0,1.80239203516036,0.270788703780532,0,0.0632527900175515,0,0,0,0,1.34683590849997,0,0,0,0,0,0.300471193172655,1.30964771221321,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0519888268875816,0,0,0.0767341010025636,0,0,0.0600009400259422],"opacity":0.5,"fill":false,"fillColor":"#03F","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-33.4738456668857,-33.4150451761182],"lng":[-70.6858063373839,-70.5912225207452]}},"evals":[],"jsHooks":[]}</script>
leaflet(width = "100%") %&gt;%
  addTiles() %&gt;%
  addPolylines(data = desire_lines, weight = desire_lines$godutch_pcycle * 5)
<div id="htmlwidget-1269500689bd8fa1f3ba" style="width:100%;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-1269500689bd8fa1f3ba">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPolylines","args":[[[[{"lng":[-70.650434858097,-70.6526255505942],"lat":[-33.4343838036132,-33.4671693192229]}]],[[{"lng":[-70.6495073830014,-70.6453902488202],"lat":[-33.4403834863821,-33.4351710188071]}]],[[{"lng":[-70.6453902488202,-70.6495073830014],"lat":[-33.4351710188071,-33.4403834863821]}]],[[{"lng":[-70.6457308854672,-70.6466592680034],"lat":[-33.4642708479547,-33.4563767538852]}]],[[{"lng":[-70.6466592680034,-70.6457308854672],"lat":[-33.4563767538852,-33.4642708479547]}]],[[{"lng":[-70.6481561394314,-70.6661174372699],"lat":[-33.446832173693,-33.4301412600966]}]],[[{"lng":[-70.6481561394314,-70.670733374992],"lat":[-33.446832173693,-33.4457783941942]}]],[[{"lng":[-70.6074971506533,-70.6526255505942],"lat":[-33.42597543057,-33.4671693192229]}]],[[{"lng":[-70.6074971506533,-70.6718290234332],"lat":[-33.42597543057,-33.4350884899849]}]],[[{"lng":[-70.6095995931768,-70.614076885476],"lat":[-33.4204893918155,-33.4150451761182]}]],[[{"lng":[-70.614076885476,-70.6074971506533],"lat":[-33.4150451761182,-33.42597543057]}]],[[{"lng":[-70.614076885476,-70.6095995931768],"lat":[-33.4150451761182,-33.4204893918155]}]],[[{"lng":[-70.5981232718602,-70.6572126224758],"lat":[-33.4265026274536,-33.4498187472731]}]],[[{"lng":[-70.5981232718602,-70.637275123409],"lat":[-33.4265026274536,-33.4546390844503]}]],[[{"lng":[-70.6012948054121,-70.6733986306119],"lat":[-33.42186018188,-33.4300771552172]}]],[[{"lng":[-70.6012948054121,-70.6774896364247],"lat":[-33.42186018188,-33.4355112027072]}]],[[{"lng":[-70.6012948054121,-70.6123578082606],"lat":[-33.42186018188,-33.4355251923086]}]],[[{"lng":[-70.6012948054121,-70.5912225207452],"lat":[-33.42186018188,-33.4345660126086]}]],[[{"lng":[-70.6285692069969,-70.651680306137],"lat":[-33.4265365578799,-33.4736786260841]}]],[[{"lng":[-70.6785522214009,-70.6858063373839],"lat":[-33.4301449875544,-33.441545791766]}]],[[{"lng":[-70.6534578266908,-70.6858063373839],"lat":[-33.4572409358982,-33.441545791766]}]],[[{"lng":[-70.6593539992795,-70.6377516282806],"lat":[-33.4738456668857,-33.4598208208412]}]],[[{"lng":[-70.6674172760907,-70.6673293221026],"lat":[-33.4636868248438,-33.4735215340682]}]],[[{"lng":[-70.6673293221026,-70.6674172760907],"lat":[-33.4735215340682,-33.4636868248438]}]],[[{"lng":[-70.6673293221026,-70.6735981986333],"lat":[-33.4735215340682,-33.469865788945]}]],[[{"lng":[-70.6673293221026,-70.6123578082606],"lat":[-33.4735215340682,-33.4355251923086]}]],[[{"lng":[-70.6735981986333,-70.6673293221026],"lat":[-33.469865788945,-33.4735215340682]}]],[[{"lng":[-70.6735981986333,-70.651680306137],"lat":[-33.469865788945,-33.4736786260841]}]],[[{"lng":[-70.6735981986333,-70.6713399356771],"lat":[-33.469865788945,-33.4404647516981]}]],[[{"lng":[-70.6735981986333,-70.6764743607833],"lat":[-33.469865788945,-33.4469856853689]}]],[[{"lng":[-70.6735981986333,-70.6551960308114],"lat":[-33.469865788945,-33.4340428489674]}]],[[{"lng":[-70.651680306137,-70.6285692069969],"lat":[-33.4736786260841,-33.4265365578799]}]],[[{"lng":[-70.651680306137,-70.6735981986333],"lat":[-33.4736786260841,-33.469865788945]}]],[[{"lng":[-70.651680306137,-70.6661174372699],"lat":[-33.4736786260841,-33.4301412600966]}]],[[{"lng":[-70.651680306137,-70.6774896364247],"lat":[-33.4736786260841,-33.4355112027072]}]],[[{"lng":[-70.6752246175601,-70.6718290234332],"lat":[-33.4626408609166,-33.4350884899849]}]],[[{"lng":[-70.6752246175601,-70.6774896364247],"lat":[-33.4626408609166,-33.4355112027072]}]],[[{"lng":[-70.6602457027671,-70.6526255505942],"lat":[-33.464301260726,-33.4671693192229]}]],[[{"lng":[-70.6602457027671,-70.6529723507626],"lat":[-33.464301260726,-33.4621181229437]}]],[[{"lng":[-70.6602457027671,-70.6713399356771],"lat":[-33.464301260726,-33.4404647516981]}]],[[{"lng":[-70.6602457027671,-70.6583561582847],"lat":[-33.464301260726,-33.4419715202788]}]],[[{"lng":[-70.6602457027671,-70.6764743607833],"lat":[-33.464301260726,-33.4469856853689]}]],[[{"lng":[-70.6602457027671,-70.6528539094186],"lat":[-33.464301260726,-33.4498033485925]}]],[[{"lng":[-70.6526255505942,-70.650434858097],"lat":[-33.4671693192229,-33.4343838036132]}]],[[{"lng":[-70.6526255505942,-70.6074971506533],"lat":[-33.4671693192229,-33.42597543057]}]],[[{"lng":[-70.6526255505942,-70.6602457027671],"lat":[-33.4671693192229,-33.464301260726]}]],[[{"lng":[-70.6526255505942,-70.6529723507626],"lat":[-33.4671693192229,-33.4621181229437]}]],[[{"lng":[-70.6526255505942,-70.6770373116317],"lat":[-33.4671693192229,-33.4409810468126]}]],[[{"lng":[-70.6526255505942,-70.6713399356771],"lat":[-33.4671693192229,-33.4404647516981]}]],[[{"lng":[-70.6526255505942,-70.6661174372699],"lat":[-33.4671693192229,-33.4301412600966]}]],[[{"lng":[-70.6526255505942,-70.6642333096546],"lat":[-33.4671693192229,-33.4398236374009]}]],[[{"lng":[-70.6526255505942,-70.6764743607833],"lat":[-33.4671693192229,-33.4469856853689]}]],[[{"lng":[-70.6526255505942,-70.670733374992],"lat":[-33.4671693192229,-33.4457783941942]}]],[[{"lng":[-70.6526255505942,-70.6590576555109],"lat":[-33.4671693192229,-33.4330876589]}]],[[{"lng":[-70.6526255505942,-70.637275123409],"lat":[-33.4671693192229,-33.4546390844503]}]],[[{"lng":[-70.6529723507626,-70.6593539992795],"lat":[-33.4621181229437,-33.4738456668857]}]],[[{"lng":[-70.6529723507626,-70.6602457027671],"lat":[-33.4621181229437,-33.464301260726]}]],[[{"lng":[-70.6529723507626,-70.6526255505942],"lat":[-33.4621181229437,-33.4671693192229]}]],[[{"lng":[-70.6529723507626,-70.6713399356771],"lat":[-33.4621181229437,-33.4404647516981]}]],[[{"lng":[-70.6529723507626,-70.6661174372699],"lat":[-33.4621181229437,-33.4301412600966]}]],[[{"lng":[-70.6529723507626,-70.6764743607833],"lat":[-33.4621181229437,-33.4469856853689]}]],[[{"lng":[-70.6529723507626,-70.670733374992],"lat":[-33.4621181229437,-33.4457783941942]}]],[[{"lng":[-70.6529723507626,-70.6528539094186],"lat":[-33.4621181229437,-33.4498033485925]}]],[[{"lng":[-70.6529723507626,-70.6590576555109],"lat":[-33.4621181229437,-33.4330876589]}]],[[{"lng":[-70.6529723507626,-70.6551960308114],"lat":[-33.4621181229437,-33.4340428489674]}]],[[{"lng":[-70.6529723507626,-70.631024899717],"lat":[-33.4621181229437,-33.4628822123352]}]],[[{"lng":[-70.6770373116317,-70.6526255505942],"lat":[-33.4409810468126,-33.4671693192229]}]],[[{"lng":[-70.6770373116317,-70.6713399356771],"lat":[-33.4409810468126,-33.4404647516981]}]],[[{"lng":[-70.6770373116317,-70.6661174372699],"lat":[-33.4409810468126,-33.4301412600966]}]],[[{"lng":[-70.6713399356771,-70.6074971506533],"lat":[-33.4404647516981,-33.42597543057]}]],[[{"lng":[-70.6713399356771,-70.6735981986333],"lat":[-33.4404647516981,-33.469865788945]}]],[[{"lng":[-70.6713399356771,-70.6602457027671],"lat":[-33.4404647516981,-33.464301260726]}]],[[{"lng":[-70.6713399356771,-70.6526255505942],"lat":[-33.4404647516981,-33.4671693192229]}]],[[{"lng":[-70.6713399356771,-70.6529723507626],"lat":[-33.4404647516981,-33.4621181229437]}]],[[{"lng":[-70.6713399356771,-70.6770373116317],"lat":[-33.4404647516981,-33.4409810468126]}]],[[{"lng":[-70.6713399356771,-70.6647209084766],"lat":[-33.4404647516981,-33.4355753657536]}]],[[{"lng":[-70.6713399356771,-70.6642333096546],"lat":[-33.4404647516981,-33.4398236374009]}]],[[{"lng":[-70.6713399356771,-70.6764743607833],"lat":[-33.4404647516981,-33.4469856853689]}]],[[{"lng":[-70.6713399356771,-70.6718290234332],"lat":[-33.4404647516981,-33.4350884899849]}]],[[{"lng":[-70.6713399356771,-70.5912225207452],"lat":[-33.4404647516981,-33.4345660126086]}]],[[{"lng":[-70.6661174372699,-70.6481561394314],"lat":[-33.4301412600966,-33.446832173693]}]],[[{"lng":[-70.6661174372699,-70.651680306137],"lat":[-33.4301412600966,-33.4736786260841]}]],[[{"lng":[-70.6661174372699,-70.6526255505942],"lat":[-33.4301412600966,-33.4671693192229]}]],[[{"lng":[-70.6661174372699,-70.6647209084766],"lat":[-33.4301412600966,-33.4355753657536]}]],[[{"lng":[-70.6661174372699,-70.6718290234332],"lat":[-33.4301412600966,-33.4350884899849]}]],[[{"lng":[-70.6661174372699,-70.6774896364247],"lat":[-33.4301412600966,-33.4355112027072]}]],[[{"lng":[-70.6661174372699,-70.6528539094186],"lat":[-33.4301412600966,-33.4498033485925]}]],[[{"lng":[-70.6647209084766,-70.6661174372699],"lat":[-33.4355753657536,-33.4301412600966]}]],[[{"lng":[-70.6647209084766,-70.6528539094186],"lat":[-33.4355753657536,-33.4498033485925]}]],[[{"lng":[-70.6647209084766,-70.6590576555109],"lat":[-33.4355753657536,-33.4330876589]}]],[[{"lng":[-70.6642333096546,-70.6526255505942],"lat":[-33.4398236374009,-33.4671693192229]}]],[[{"lng":[-70.6642333096546,-70.6713399356771],"lat":[-33.4398236374009,-33.4404647516981]}]],[[{"lng":[-70.6642758332154,-70.6590576555109],"lat":[-33.4446572092606,-33.4330876589]}]],[[{"lng":[-70.6583561582847,-70.6602457027671],"lat":[-33.4419715202788,-33.464301260726]}]],[[{"lng":[-70.6583561582847,-70.6764743607833],"lat":[-33.4419715202788,-33.4469856853689]}]],[[{"lng":[-70.6583561582847,-70.6572126224758],"lat":[-33.4419715202788,-33.4498187472731]}]],[[{"lng":[-70.6542364764179,-70.6528539094186],"lat":[-33.441245136987,-33.4498033485925]}]],[[{"lng":[-70.6764743607833,-70.6602457027671],"lat":[-33.4469856853689,-33.464301260726]}]],[[{"lng":[-70.6764743607833,-70.6529723507626],"lat":[-33.4469856853689,-33.4621181229437]}]],[[{"lng":[-70.6764743607833,-70.6713399356771],"lat":[-33.4469856853689,-33.4404647516981]}]],[[{"lng":[-70.6764743607833,-70.6642333096546],"lat":[-33.4469856853689,-33.4398236374009]}]],[[{"lng":[-70.6764743607833,-70.6583561582847],"lat":[-33.4469856853689,-33.4419715202788]}]],[[{"lng":[-70.6764743607833,-70.670733374992],"lat":[-33.4469856853689,-33.4457783941942]}]],[[{"lng":[-70.6764743607833,-70.6528539094186],"lat":[-33.4469856853689,-33.4498033485925]}]],[[{"lng":[-70.6764743607833,-70.5949751541645],"lat":[-33.4469856853689,-33.4306315476572]}]],[[{"lng":[-70.670733374992,-70.6481561394314],"lat":[-33.4457783941942,-33.446832173693]}]],[[{"lng":[-70.670733374992,-70.6602457027671],"lat":[-33.4457783941942,-33.464301260726]}]],[[{"lng":[-70.670733374992,-70.6526255505942],"lat":[-33.4457783941942,-33.4671693192229]}]],[[{"lng":[-70.670733374992,-70.6529723507626],"lat":[-33.4457783941942,-33.4621181229437]}]],[[{"lng":[-70.670733374992,-70.6764743607833],"lat":[-33.4457783941942,-33.4469856853689]}]],[[{"lng":[-70.6733986306119,-70.6526255505942],"lat":[-33.4300771552172,-33.4671693192229]}]],[[{"lng":[-70.6733986306119,-70.6642758332154],"lat":[-33.4300771552172,-33.4446572092606]}]],[[{"lng":[-70.6733986306119,-70.6718290234332],"lat":[-33.4300771552172,-33.4350884899849]}]],[[{"lng":[-70.6733986306119,-70.6774896364247],"lat":[-33.4300771552172,-33.4355112027072]}]],[[{"lng":[-70.6733986306119,-70.6590576555109],"lat":[-33.4300771552172,-33.4330876589]}]],[[{"lng":[-70.6718290234332,-70.6074971506533],"lat":[-33.4350884899849,-33.42597543057]}]],[[{"lng":[-70.6718290234332,-70.6752246175601],"lat":[-33.4350884899849,-33.4626408609166]}]],[[{"lng":[-70.6718290234332,-70.6529723507626],"lat":[-33.4350884899849,-33.4621181229437]}]],[[{"lng":[-70.6718290234332,-70.6661174372699],"lat":[-33.4350884899849,-33.4301412600966]}]],[[{"lng":[-70.6718290234332,-70.6774896364247],"lat":[-33.4350884899849,-33.4355112027072]}]],[[{"lng":[-70.6774896364247,-70.6012948054121],"lat":[-33.4355112027072,-33.42186018188]}]],[[{"lng":[-70.6774896364247,-70.651680306137],"lat":[-33.4355112027072,-33.4736786260841]}]],[[{"lng":[-70.6774896364247,-70.6752246175601],"lat":[-33.4355112027072,-33.4626408609166]}]],[[{"lng":[-70.6774896364247,-70.6642333096546],"lat":[-33.4355112027072,-33.4398236374009]}]],[[{"lng":[-70.6774896364247,-70.6733986306119],"lat":[-33.4355112027072,-33.4300771552172]}]],[[{"lng":[-70.6774896364247,-70.6718290234332],"lat":[-33.4355112027072,-33.4350884899849]}]],[[{"lng":[-70.6774896364247,-70.6296037029705],"lat":[-33.4355112027072,-33.4696442284046]}]],[[{"lng":[-70.6572126224758,-70.5981232718602],"lat":[-33.4498187472731,-33.4265026274536]}]],[[{"lng":[-70.6572126224758,-70.6583561582847],"lat":[-33.4498187472731,-33.4419715202788]}]],[[{"lng":[-70.6572126224758,-70.6733986306119],"lat":[-33.4498187472731,-33.4300771552172]}]],[[{"lng":[-70.6528539094186,-70.6602457027671],"lat":[-33.4498033485925,-33.464301260726]}]],[[{"lng":[-70.6528539094186,-70.6526255505942],"lat":[-33.4498033485925,-33.4671693192229]}]],[[{"lng":[-70.6528539094186,-70.6529723507626],"lat":[-33.4498033485925,-33.4621181229437]}]],[[{"lng":[-70.6528539094186,-70.6647209084766],"lat":[-33.4498033485925,-33.4355753657536]}]],[[{"lng":[-70.6528539094186,-70.6542364764179],"lat":[-33.4498033485925,-33.441245136987]}]],[[{"lng":[-70.6528539094186,-70.670733374992],"lat":[-33.4498033485925,-33.4457783941942]}]],[[{"lng":[-70.6590576555109,-70.6526255505942],"lat":[-33.4330876589,-33.4671693192229]}]],[[{"lng":[-70.6590576555109,-70.6529723507626],"lat":[-33.4330876589,-33.4621181229437]}]],[[{"lng":[-70.6590576555109,-70.6647209084766],"lat":[-33.4330876589,-33.4355753657536]}]],[[{"lng":[-70.6590576555109,-70.6642758332154],"lat":[-33.4330876589,-33.4446572092606]}]],[[{"lng":[-70.6590576555109,-70.6733986306119],"lat":[-33.4330876589,-33.4300771552172]}]],[[{"lng":[-70.6590576555109,-70.6528539094186],"lat":[-33.4330876589,-33.4498033485925]}]],[[{"lng":[-70.6551960308114,-70.6466592680034],"lat":[-33.4340428489674,-33.4563767538852]}]],[[{"lng":[-70.637275123409,-70.5981232718602],"lat":[-33.4546390844503,-33.4265026274536]}]],[[{"lng":[-70.637275123409,-70.6526255505942],"lat":[-33.4546390844503,-33.4671693192229]}]],[[{"lng":[-70.637275123409,-70.631024899717],"lat":[-33.4546390844503,-33.4628822123352]}]],[[{"lng":[-70.631024899717,-70.6529723507626],"lat":[-33.4628822123352,-33.4621181229437]}]],[[{"lng":[-70.631024899717,-70.637275123409],"lat":[-33.4628822123352,-33.4546390844503]}]],[[{"lng":[-70.6206661133164,-70.6356675455178],"lat":[-33.4438231516899,-33.4717301363876]}]],[[{"lng":[-70.6108265415944,-70.6356675455178],"lat":[-33.4424221730401,-33.4717301363876]}]],[[{"lng":[-70.6123578082606,-70.6356675455178],"lat":[-33.4355251923086,-33.4717301363876]}]],[[{"lng":[-70.6356675455178,-70.6206661133164],"lat":[-33.4717301363876,-33.4438231516899]}]],[[{"lng":[-70.6356675455178,-70.6108265415944],"lat":[-33.4717301363876,-33.4424221730401]}]],[[{"lng":[-70.6356675455178,-70.6123578082606],"lat":[-33.4717301363876,-33.4355251923086]}]],[[{"lng":[-70.6356675455178,-70.6296037029705],"lat":[-33.4717301363876,-33.4696442284046]}]],[[{"lng":[-70.6356675455178,-70.6341487532638],"lat":[-33.4717301363876,-33.446893522726]}]],[[{"lng":[-70.6296037029705,-70.6774896364247],"lat":[-33.4696442284046,-33.4355112027072]}]],[[{"lng":[-70.6296037029705,-70.6356675455178],"lat":[-33.4696442284046,-33.4717301363876]}]],[[{"lng":[-70.6296037029705,-70.6341487532638],"lat":[-33.4696442284046,-33.446893522726]}]],[[{"lng":[-70.6377516282806,-70.6593539992795],"lat":[-33.4598208208412,-33.4738456668857]}]],[[{"lng":[-70.6377516282806,-70.644601717137],"lat":[-33.4598208208412,-33.4400985482313]}]],[[{"lng":[-70.6377516282806,-70.6312044546103],"lat":[-33.4598208208412,-33.438242424246]}]],[[{"lng":[-70.638602501405,-70.641797063688],"lat":[-33.4657345509482,-33.44407850438]}]],[[{"lng":[-70.644601717137,-70.6377516282806],"lat":[-33.4400985482313,-33.4598208208412]}]],[[{"lng":[-70.644601717137,-70.6341487532638],"lat":[-33.4400985482313,-33.446893522726]}]],[[{"lng":[-70.644601717137,-70.6368724960347],"lat":[-33.4400985482313,-33.4402785483282]}]],[[{"lng":[-70.644601717137,-70.6314487503384],"lat":[-33.4400985482313,-33.4328823211947]}]],[[{"lng":[-70.6341487532638,-70.6206661133164],"lat":[-33.446893522726,-33.4438231516899]}]],[[{"lng":[-70.6341487532638,-70.6356675455178],"lat":[-33.446893522726,-33.4717301363876]}]],[[{"lng":[-70.6341487532638,-70.6296037029705],"lat":[-33.446893522726,-33.4696442284046]}]],[[{"lng":[-70.6341487532638,-70.638602501405],"lat":[-33.446893522726,-33.4657345509482]}]],[[{"lng":[-70.6341487532638,-70.644601717137],"lat":[-33.446893522726,-33.4400985482313]}]],[[{"lng":[-70.6341487532638,-70.6368724960347],"lat":[-33.446893522726,-33.4402785483282]}]],[[{"lng":[-70.6341487532638,-70.6312044546103],"lat":[-33.446893522726,-33.438242424246]}]],[[{"lng":[-70.6341487532638,-70.6199652917226],"lat":[-33.446893522726,-33.4349547244951]}]],[[{"lng":[-70.6341487532638,-70.6252869928988],"lat":[-33.446893522726,-33.4361581067883]}]],[[{"lng":[-70.6341487532638,-70.6314487503384],"lat":[-33.446893522726,-33.4328823211947]}]],[[{"lng":[-70.6341487532638,-70.6397451799901],"lat":[-33.446893522726,-33.4493577681257]}]],[[{"lng":[-70.6368724960347,-70.644601717137],"lat":[-33.4402785483282,-33.4400985482313]}]],[[{"lng":[-70.6368724960347,-70.6341487532638],"lat":[-33.4402785483282,-33.446893522726]}]],[[{"lng":[-70.6368724960347,-70.6312044546103],"lat":[-33.4402785483282,-33.438242424246]}]],[[{"lng":[-70.6312044546103,-70.6377516282806],"lat":[-33.438242424246,-33.4598208208412]}]],[[{"lng":[-70.6312044546103,-70.6341487532638],"lat":[-33.438242424246,-33.446893522726]}]],[[{"lng":[-70.6312044546103,-70.6368724960347],"lat":[-33.438242424246,-33.4402785483282]}]],[[{"lng":[-70.6199652917226,-70.6377516282806],"lat":[-33.4349547244951,-33.4598208208412]}]],[[{"lng":[-70.6199652917226,-70.6341487532638],"lat":[-33.4349547244951,-33.446893522726]}]],[[{"lng":[-70.6199652917226,-70.6296537305289],"lat":[-33.4349547244951,-33.4451758586847]}]],[[{"lng":[-70.6199652917226,-70.6252869928988],"lat":[-33.4349547244951,-33.4361581067883]}]],[[{"lng":[-70.6252869928988,-70.6341487532638],"lat":[-33.4361581067883,-33.446893522726]}]],[[{"lng":[-70.6252869928988,-70.6199652917226],"lat":[-33.4361581067883,-33.4349547244951]}]],[[{"lng":[-70.6314487503384,-70.644601717137],"lat":[-33.4328823211947,-33.4400985482313]}]],[[{"lng":[-70.6314487503384,-70.6341487532638],"lat":[-33.4328823211947,-33.446893522726]}]],[[{"lng":[-70.6397451799901,-70.6341487532638],"lat":[-33.4493577681257,-33.446893522726]}]],[[{"lng":[-70.641797063688,-70.638602501405],"lat":[-33.44407850438,-33.4657345509482]}]],[[{"lng":[-70.5949751541645,-70.6713399356771],"lat":[-33.4306315476572,-33.4404647516981]}]],[[{"lng":[-70.5949751541645,-70.6764743607833],"lat":[-33.4306315476572,-33.4469856853689]}]],[[{"lng":[-70.6032789286817,-70.5912225207452],"lat":[-33.4413898286572,-33.4345660126086]}]],[[{"lng":[-70.5912225207452,-70.6012948054121],"lat":[-33.4345660126086,-33.42186018188]}]],[[{"lng":[-70.5912225207452,-70.6713399356771],"lat":[-33.4345660126086,-33.4404647516981]}]],[[{"lng":[-70.5912225207452,-70.6032789286817],"lat":[-33.4345660126086,-33.4413898286572]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":[2.22762703873584,2.07383291784758,2.07383291784758,2.16394060044467,2.16394060044467,2.35460320786475,2.36414034784622,1.71349019542366,1.74706609319302,2.09542156154809,2.30085438097974,2.09542156154809,1.74490418011876,2.01900108442424,1.59136394983906,1.48585461776555,2.35594458329073,2.3457659833485,1.83382578190876,2.31385294045733,2.25443585584453,2.352155676059,2.23783243647001,2.23783243647001,2.08223335313754,1.62049597974868,2.08223335313754,2.36395909958327,2.28118679717328,2.35104404182492,2.10953810861321,1.83382578190876,2.36395909958327,1.97173361851816,2.00291510461842,2.30503630824224,2.3112372638428,2.11618681858444,2.08631815534108,2.32933105813673,2.35487610021818,2.35704962984684,2.35052024533436,2.22762703873584,1.71349019542366,2.11618681858444,1.99190396233125,2.22172821831386,2.25899824039207,2.11524689221289,2.28758472233402,2.29668707341712,2.32282381691978,2.19792422146229,2.36244887657099,2.31333221035352,2.08631815534108,1.99190396233125,2.31904511987392,2.21057578711059,2.33707779068482,2.35665270097959,2.30254820090086,2.28104556239089,2.29939702829262,2.36342140860038,2.22172821831386,1.96986017351845,2.3333305381414,1.72830071523338,2.28118679717328,2.32933105813673,2.25899824039207,2.31904511987392,1.96986017351845,2.1372528078967,2.05617829027362,2.15794637102659,2.01678964859777,1.4356760767853,2.35460320786475,1.97173361851816,2.11524689221289,2.02863708518111,2.11049301367525,2.26950338637889,2.35383821079821,2.02863708518111,2.3603951806757,2.01308057641235,2.28758472233402,2.05617829027362,2.30349024277772,2.35487610021818,2.35192851403821,2.16270403562371,2.19420228974886,2.35704962984684,2.33707779068482,2.15794637102659,2.30573647609236,2.35192851403821,1.98256131845281,2.3637994712926,1.36839510402938,2.36414034784622,2.36269579425186,2.32282381691978,2.35665270097959,1.98256131845281,2.06740653827817,2.35566290276651,2.00109399845421,2.08446707784643,2.30307060605295,1.74706609319302,2.30503630824224,2.25358903086086,2.11049301367525,1.96662372555084,1.48585461776555,2.00291510461842,2.3112372638428,2.29316681823353,2.08446707784643,1.96662372555084,1.79419426462124,1.74490418011876,2.16270403562371,2.34434667931119,2.35052024533436,2.36053060849555,2.30254820090086,2.3603951806757,2.19420228974886,2.34784559851144,2.19792422146229,2.28104556239089,2.01308057641235,2.30349024277772,2.30307060605295,2.361056510336,2.34799643130432,2.01900108442424,2.36244887657099,2.23517073795765,2.36342140860038,2.23517073795765,2.26443542483616,2.17163159473916,2.06400028823839,2.26443542483616,2.17163159473916,2.06400028823839,2.0225295674709,2.33615298571872,1.79419426462124,2.0225295674709,2.35064922531624,2.352155676059,2.36257553754904,2.35558218406434,2.35784246311855,2.36257553754904,2.27352211835972,2.08654063691368,2.31781894260242,2.28837405267901,2.33615298571872,2.35064922531624,2.36427122824197,2.27352211835972,2.11730264853391,2.20819830150323,2.35784350693068,2.31609922064166,2.33372747697378,2.00859189097724,2.08654063691368,2.11730264853391,1.99880261570476,2.35558218406434,2.20819830150323,1.99880261570476,2.28830792045027,2.35784350693068,2.316034184432,1.95479892865434,2.31609922064166,1.95479892865434,2.31781894260242,2.33372747697378,2.00859189097724,2.35784246311855,1.49942274551392,1.36839510402938,2.29928233279208,2.3457659833485,1.4356760767853,2.29928233279208],"opacity":0.5,"fill":false,"fillColor":"#03F","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-33.4738456668857,-33.4150451761182],"lng":[-70.6858063373839,-70.5912225207452]}},"evals":[],"jsHooks":[]}</script><p>The results show that there is substantial potential for increasing the levels of cycling in central Santiago, based on origin-destination data alone. However, to inform policy, more detailed estimates of cycling potential are needed, with results that go down to the level of individual streets. This involves routing.</p>
</div>
<div class="section level2">
<h2 id="routing">Routing<a class="anchor" aria-label="anchor" href="#routing"></a>
</h2>
<p>There are many ways to do calculate a path on the street network. The main options are local routing, where the calculation is done based on data stored locally (on your computer) and routing services, where the data is done remotely (‘in the cloud’). Let’s use a remote routing service to convert the straight lines generated in the previous section into routes that could realistically be taken by people cycling (the next line does not run by default because it requires an API key saved as an environment variable, see the <a href="https://docs.ropensci.org/stplanr/reference/index.html#section-routing" class="external-link">documentation of <code>route_cyclestreets()</code> for details</a> for details).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">santiago_routes_cs</span> <span class="op">=</span> <span class="fu">stplanr</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/stplanr/reference/line2route.html" class="external-link">line2route</a></span><span class="op">(</span><span class="va">desire_lines</span><span class="op">)</span>
<span class="co"># &gt; 10 % out of 200 distances calculated</span>
<span class="co"># &gt; 20 % out of 200 distances calculated</span>
<span class="co"># &gt; 30 % out of 200 distances calculated</span>
<span class="co"># &gt; 40 % out of 200 distances calculated</span>
<span class="co"># &gt; 50 % out of 200 distances calculated</span>
<span class="co"># &gt; 60 % out of 200 distances calculated</span>
<span class="co"># &gt; 70 % out of 200 distances calculated</span>
<span class="co"># &gt; 80 % out of 200 distances calculated</span>
<span class="co"># &gt; 90 % out of 200 distances calculated</span>
<span class="co"># &gt; 100 % out of 200 distances calculated</span>
<span class="co"># &gt; Warning message:</span>
<span class="co"># &gt; In value[[3L]](cond) : Fail for line number 32</span></code></pre></div>
<p>Note that one of the routes failed. We can look at this route as follows, to try to understand what happened:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addPolylines</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">santiago_routes_cs</span><span class="op">[</span><span class="fl">32</span>, <span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span></code></pre></div>
<div id="htmlwidget-42262ea01e82cbeb2cff" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-42262ea01e82cbeb2cff">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPolylines","args":[[[[{"lng":[-70.6516802927893,-70.6285692759411],"lat":[-33.4736786518947,-33.4265365888878]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":false,"fillColor":"#03F","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-33.4736786518947,-33.4265365888878],"lng":[-70.6516802927893,-70.6285692759411]}},"evals":[],"jsHooks":[]}</script><p>The result shows that one end of the route connects to the Sendero Ciclistas, which the routing service may be unable to reach. At this stage there are 2 main options: 1) to omit the data point from the analysis, acknowledging that the data is incomplete; or 2) identify a nearby location where the service <em>can</em> route to. In this case we will take option 1. Before we remove the offending line 32 from the analysis, we will join the data from the desire lines back onto the results:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">routes</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">santiago_routes_cs</span><span class="op">)</span>,
  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">desire_lines</span><span class="op">)</span><span class="op">)</span>,
  geometry <span class="op">=</span> <span class="va">santiago_routes_cs</span><span class="op">$</span><span class="va">geometry</span>
<span class="op">)</span></code></pre></div>
<p>Update results…</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">routes</span><span class="op">$</span><span class="va">godutch_slc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">routes</span><span class="op">$</span><span class="va">godutch_pcycle</span> <span class="op">*</span> <span class="va">routes</span><span class="op">$</span><span class="va">all</span><span class="op">)</span>
<span class="va">rnet</span> <span class="op">=</span> <span class="fu">stplanr</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/stplanr/reference/overline.html" class="external-link">overline2</a></span><span class="op">(</span><span class="va">routes</span>, <span class="st">"godutch_slc"</span><span class="op">)</span>
<span class="co">#&gt; old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rnet</span>, lwd <span class="op">=</span> <span class="va">rnet</span><span class="op">$</span><span class="va">godutch_slc</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rnet</span><span class="op">$</span><span class="va">godutch_slc</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="pct-international_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># library(tmap)</span>
<span class="co"># tmap_mode("view")</span>
<span class="co">#   tm_shape(rnet) +</span>
<span class="co">#   tm_lines(lwd = "godutch_slc", scale = 9) </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>Clearly to do this in a production environment we would use a larger dataset, but the concepts would be the same. We would refine the method in multiple ways. The next basic step, however, would be to convert the straight desire lines into routes, to calculate more accurate distance and hilliness levels for each OD pair. Then we would be able to create a route network to help prioritise cycling across the city.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">route_segments_1_5</span> <span class="op">=</span> <span class="fu">route</span><span class="op">(</span>l <span class="op">=</span> <span class="va">desire_lines</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span>, route_fun <span class="op">=</span> <span class="fu">cyclestreets</span><span class="fu">::</span><span class="va">journey</span><span class="op">)</span>
<span class="fu">mapview</span><span class="fu">::</span><span class="fu">mapview</span><span class="op">(</span><span class="va">route_segments_1_5</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Robin Lovelace, Layik Hama.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
